# 标准执行步骤（分步运行，清晰可控）
## 步骤 1：安装依赖（仅需执行 1 次）
```bash
运行
# 升级pip，用国内镜像加快速度
pip3 install --upgrade pip -i https://mirrors.aliyun.com/pypi/simple/
# 安装核心依赖（Mac无需装bitsandbytes）
pip3 install torch transformers datasets peft accelerate -i https://mirrors.aliyun.com/pypi/simple/
```

## 步骤 2：生成测试数据
```bash
python3 01_generate_data.py
# 预期输出：✅ 成功生成100条测试数据，保存到：./demo_data.jsonl
```
## 步骤 3：执行 LoRA 微调
```bash
python3 02_finetune.py
# 预期输出：
# 🚀 开始加载模型...
# trainable params: 524,288 || all params: 1,800,000,000 || trainable%: 0.0291
# 🔥 开始训练...
# ✅ 训练完成！模型保存到：./mac_demo
```
## 步骤 4：推理验证
```bash
python3 03_infer.py
# 预期输出：
# 🚀 加载模型和LoRA权重...
# 🔍 开始生成结果...
# ===== 推理结果 =====
# 输入文本：[doc]...
# 模型生成的修复函数：merge_line(start=10000, end=10001, content="3.1 双绞线\n双绞线(Twisted Pair wire, TP)是建筑设备监控系统中最常用的一种传输介质。")
```

## 总结
结构清晰：3 个脚本职责单一，数据生成→训练→推理完全解耦，可单独修改 / 调试；
Mac 适配：所有配置针对 M3 32G 优化，无显存溢出、无 CUDA 依赖；
易扩展：后续要增加数据量 / 调整参数，只需修改01_generate_data.py的num_samples或02_finetune.py的训练参数；
可验证：每一步都有明确的成功提示，出错时能快速定位问题（比如数据生成失败→查 01 脚本，训练报错→查 02 脚本）。
如果某一步出现报错（比如模型下载慢、训练卡住），直接贴出报错信息，我会帮你针对性解决。